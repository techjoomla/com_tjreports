if(void 0===tjrContentUI)var tjrContentUI={};tjrContentUI.root_url="undefined"==typeof root_url?"":root_url,tjrContentUI.base_url="undefined"==typeof root_url?"":root_url,tjrContentUI.report=tjrContentUI.report?tjrContentUI.report:{},addMorefilterCnt=1,jQuery.extend(tjrContentUI.report,{searchToggle:!0,$form:null,url:"index.php?option=com_tjreports&view=reports&format=json",querySaveUrl:"index.php?option=com_tjreports&format=json",submitTJRData:function(e,t,r=""){var o="default";if("summary"==(e=void 0===e?"default":e)?(o="summary",jQuery("#summaryReportLabel").addClass("btn-danger"),jQuery("#detailsReportLabel").removeClass("btn-success"),jQuery("#reportPagination").hide(),jQuery("#pagination").hide()):(jQuery("#detailsReportLabel").removeClass("btn-success"),jQuery("#summaryReportLabel").removeClass("btn-danger"),jQuery("#reportPagination").show(),jQuery("#pagination").show()),jQuery("#reports-container .hasTooltip").tooltip("destroy"),this.searchToggle=jQuery("div#topFilters").is(":visible"),tjrContentUI.utility.loadingLayer("show"),this.$form=jQuery("#adminForm"),addMorefilterCnt>=1&&(1===parseInt(t)?addMorefilterCnt++:Number.isInteger(r)&&addMorefilterCnt--,jQuery("#tjReportaddMorefilter").remove(),this.$form.append('<input type="hidden" id="tjReportaddMorefilter" name="addMorefilter" value='+addMorefilterCnt+">"),jQuery("#tjReportremoveFilter").remove(),this.$form.append('<input type="hidden" id="tjReportremoveFilter" name="removeFilter" value='+r+">")),!this.validate())return!1;jQuery(".hasPopover").popover("destroy"),tjrContentService.postData(this.url+"&tpl="+o,this.$form.serialize()).fail(function(e){console.log("Something went wrong."),tjrContentUI.utility.loadingLayer("hide"),403==e.status&&alert(Joomla.JText._("JERROR_ALERTNOAUTHOR"))}).done(function(t){if(tjrContentUI.utility.loadingLayer("hide"),"summary"==o)jQuery("#report-containing-div").html(t.html);else{var r=jQuery(t.html).find("#j-main-container").html();jQuery("#j-main-container").html(r),"undefined"!=typeof tjutilitysendemail&&jQuery("body").find(".td-sendemail").length>0&&tjutilitysendemail.addColumn("report-table"),jQuery(".hasPopover").popover({html:!0,trigger:"hover focus",container:"body"}),"showHide"==e&&tjrContentUI.report.getColNames();var n=jQuery("#j-main-container .field-calendar");for(i=0;i<n.length;i++)JoomlaCalendar.init(n[i]);jQuery.prototype.chosen&&jQuery("#j-main-container select").chosen(),"reset"==e&&(tjrContentUI.report.searchToggle=!1),tjrContentUI.report.searchToggle&&(jQuery("#show-filter").addClass("btn-primary").find("i").removeClass("fa-caret-down").addClass("fa-caret-up"),jQuery("#topFilters").show()),jQuery(".btn-displayReport").toggleClass("active btn-success")}}).always(function(e){jQuery(".filter-hide").parents(".col-filter-header").hide(),jQuery(".filter-show").parents("th").find(".table-heading").hide()})},showFilter:function(){jQuery("#show-filter").toggleClass("btn-primary"),jQuery("#topFilters").slideToggle("1000"),jQuery("#show-filter .fa").toggleClass("fa-caret-up").toggleClass("fa-caret-down")},resetSubmitTJRData:function(e,t){t=t&&t.length?t:"#topFilters",jQuery("input:text",t).val(""),jQuery(":input",t).not(":button, :submit, :reset, input:hidden").val("").removeAttr("checked").removeAttr("selected"),addMorefilterCnt=1,tjrContentUI.report.submitTJRData(e)},validate:function(){return!0},getColNames:function(){jQuery(".ColVis_collection").toggle()},cancel:function(){jQuery("#btn-cancel").hide(),jQuery(".saveData").html("Want to save this?"),jQuery('#adminForm1 input[type="text"]').val(""),jQuery(".cancel-btn").hide(),jQuery("#queryName").val("")},saveThisQuery:function(){this.$form=jQuery("#adminForm");var e=jQuery("#queryName").is(":hidden");if(jQuery("#btn-cancel").show(),jQuery(".cancel-btn").show(),jQuery("input").css("margin-bottom","0px"),1==e)jQuery("#queryName").show(),jQuery("#saveQuery").html(Joomla.JText._("COM_TJREPORTS_SAVE_QUERY"));else{var t=jQuery("#queryName").val();if(""===t)return alert(Joomla.JText._("COM_TJREPORTS_ENTER_TITLE")),!1;jQuery("#task",this.$form).val("reports.saveQuery");var r=this.$form.serialize();jQuery("#task",this.$form).val(""),tjrContentUI.utility.loadingLayer(),tjrContentService.postData(this.querySaveUrl+"&queryName="+t,r).fail(function(e){console.log("Something went wrong."),tjrContentUI.utility.loadingLayer("hide")}).done(function(e){tjrContentUI.utility.loadingLayer("hide"),e.success?window.location.reload():console.log("Something went wrong.",e.message,e.messages)})}},deleteThisQuery:function(){this.$form=jQuery("#adminForm");jQuery("#queryName").is(":hidden");var e=jQuery("#queryId").val();if(""===e)return alert("Select Any of the query"),!1;if(deletemsg=Joomla.JText._("COM_TJREPORTS_DELETE_MESSAGE"),confirm(deletemsg)){jQuery("#task",this.$form).val("reports.deleteQuery");var t=this.$form.serialize();tjrContentUI.utility.loadingLayer(),tjrContentService.postData(this.querySaveUrl+"&queryId="+e,t).fail(function(e){console.log("Something went wrong."),tjrContentUI.utility.loadingLayer("hide")}).done(function(e){tjrContentUI.utility.loadingLayer("hide"),e.success?(tjrContentUI.utility.setJSCookie("showdeletemsg","1",1),window.location.reload()):console.log("Something went wrong.",e.message,e.messages)})}},getQueryResult:function(e){var t=tjrContentUI.base_url+"index.php?option=com_tjreports&view=reports";jQuery.each({client:"client",reportId:"reportId",queryId:"queryId"},function(e,r){var o=jQuery("#"+e).val();o&&(t+="&"+r+"="+o)}),window.location.href=t},submitForm:function(){return!!jQuery("#task").val()||(tjrContentUI.report.submitTJRData("submit"),!1)},loadReport:function(e,t){jQuery(e).val();var r=jQuery(e).find(":selected").attr("data-reportid"),o=jQuery(document.adminForm).attr("action")+"&reportId="+r;jQuery("#report-select options").attr("selected","selected"),t&&(o=o+"&client="+t),window.location.href=o},submitOnEnter:function(e){return"keydown"!=e.type||13!=e.which&&13!=e.keyCode||tjrContentUI.report.submitTJRData(),!1},attachCalSubmit:function(e){var t=JoomlaCalendar.getCalObject(e);t&&!t._joomlaCalendar.params.onUpdate&&(t._joomlaCalendar.params.onUpdate=tjrContentUI.report.submitCalForm)},submitCalForm:function(){tjrContentUI.report.submitTJRData()}}),tjrContentUI.validation=tjrContentUI.validation?tjrContentUI.validation:{},jQuery.extend(tjrContentUI.validation,{messages:{},resetInvalidField:function(e,t,r){e&&e.val(""),this.addMessage(t,r)},addMessage:function(e,t){t=t||"error",this.messages[t]=this.messages[t]?this.messages[t]:[],this.messages[t].push(e)},resetMessages:function(){Joomla.removeMessages(),this.messages={}},isValidDate:function(e){return null!=(e=e.split(" "))[0].match(/^\d{4}[-](0?[1-9]|1[012])[-](0?[1-9]|[12][0-9]|3[01])$/)},isValidCalDate:function(e,t){return void 0===Date.parseDate?this.isValidDate(date):(t||(t="%d-%m-%Y"),Date.parseDate(e,t).print(t)==e||void 0)}}),tjrContentUI.utility=tjrContentUI.utility?tjrContentUI.utility:{},jQuery.extend(tjrContentUI.utility,{getTimeStampFromDate:function(e,t){if(void 0!==Date.parseDate){t||(t="%d-%m-%Y");var r=Date.parseDate(e,t);if(r)return r.getTime()}return e},loadingLayer:function(e,t){if(e=e||"show",t=t||document.body,"load"==e){var r=document.createElement("div");r.id="loading-logo",r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%",r.style.opacity="0.8",r.style.filter="alpha(opacity=80)",r.style.overflow="hidden",r.style["z-index"]="10000",r.style.display="none",r.style["background-color"]="#fff",r.style["background-image"]='url("'+tjrContentUI.root_url+'/components/com_tjreports/assets/images/loadinfo.gif")',r.style["background-position"]="center",r.style["background-repeat"]="no-repeat",r.style["background-attachment"]="fixed",r.style["background-size"]="200px",t.appendChild(r)}else document.getElementById("loading-logo")||this.loadingLayer("load",t),document.getElementById("loading-logo").style.display="show"==e?"block":"none";return document.getElementById("loading-logo")},noScript:function(e){var t=jQuery("<div>").html(e);return t.find("script").remove(),e=t.html()},displayMessage:function(e,t,r){this.parent.validation.messages={},this.parent.validation.addMessage(e,t),this.displayMessages()},displayMessages:function(e){Joomla.removeMessages(),Joomla.renderMessages(this.parent.validation.messages),e&&jQuery("body").animate({scrollTop:jQuery("#system-message-container").offset().top},500)},setJSCookie:function(e,t,r){var o="";if(r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3),o="; expires="+n.toUTCString()}document.cookie=e+"="+t+o+"; path=/"},getJSCookie:function(e){for(var t=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var n=r[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null},eraseJSCookie:function(e){tjrContentUI.utility.setJSCookie(e,"",-1)},initiateChznPlaceholders:function(e){jQuery(document).ready(function(){for(let t=0;t<parseInt(addMorefilterCnt);t++)for(let r in e)jQuery("#filtersoptions_"+t+r+"_chzn").find("li.search-field input.default").val(e[r])})}}),tjrContentUI.tjreport=tjrContentUI.tjreport?tjrContentUI.tjreport:{},jQuery.extend(tjrContentUI.tjreport,{getPlugins:function(){var e=jQuery("#adminForm.tjreportForm");jQuery("#task",e).val("tjreport.getplugins");var t=tjrContentService.postData("index.php?option=com_tjreports&format=json",e.serialize());jQuery("#task",e).val(),jQuery("#jform_parent",e).find("option").not(":first").remove(),t.fail(function(e){console.log("Something went wrong."),403==e.status&&alert(Joomla.JText._("JERROR_ALERTNOAUTHOR"))}).done(function(e){if(e.success){var t=jQuery("#jform_parent");jQuery.each(e.data,function(e,r){t.append(new Option(r.text,r.value))}),tjrContentUI.tjreport.getParams()}else console.log("Something went wrong.",e.message,e.messages)})},loadSort:function(){jQuery(".col-filter-header").hide(),jQuery(document).on("click",".col-search",function(){var e=jQuery(this).parents("th");jQuery(".col-filter-header",e).show(),jQuery(".chzn-search").children("input").attr("readOnly",!1),jQuery(".table-heading",e).hide()}),jQuery(document).on("click",".close-icon",function(){var e=jQuery(this).parents("th");jQuery(".table-heading",e).show(),jQuery(".col-filter-header",e).hide(),tjrContentUI.report.resetSubmitTJRData("submit",e)})},getParams:function(e){var t="index.php?option=com_tjreports&format=json";e&&(t+="&default=1");var r=jQuery("#adminForm.tjreportForm");jQuery("#task",r).val("tjreport.getparams");var o=tjrContentService.postData(t,r.serialize());jQuery("#task",r).val(),jQuery("#jform_param",r).val(""),jQuery("#jform_plugin",r).val(""),o.fail(function(e){console.log("Something went wrong."),403==e.status&&alert(Joomla.JText._("JERROR_ALERTNOAUTHOR"))}).done(function(e){if(e.success){var t=JSON.stringify(JSON.parse(e.data.param),null,"\t");jQuery("#jform_param",r).val(t),jQuery("#jform_plugin",r).val(e.data.plugin)}else console.log("Something went wrong.",e.message,e.messages)})}}),jQuery(document).click(function(e){jQuery(e.target).closest("#ul-columns-name").length||"show-hide-cols-btn"==e.target.id||jQuery(".ColVis_collection").hide()}),jQuery(document).ready(function(){jQuery("#topFilters").hide(),jQuery("#btn-cancel").hide(),jQuery(".cancel-btn").hide(),tjrContentUI.tjreport.loadSort(),tjrContentUI.utility.getJSCookie("showdeletemsg")&&(Joomla.JText.strings.SUCCESS||(Joomla.JText.strings.SUCCESS="Success"),Joomla.renderMessages({success:[Joomla.JText._("COM_TJREPORTS_QUERY_DELETE_SUCCESS")]}),tjrContentUI.utility.eraseJSCookie("showdeletemsg")),jQuery(document).on("click",'#reports-container a[href="#"]',function(e){e.preventDefault()})}),jQuery(document).ready(function(){jQuery("#report-table").on("liszt:ready","select",function(){jQuery(this).next(".chzn-container-single-nosearch").removeClass("chzn-container-single-nosearch")})});
